<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Generador de Sudoku (Web)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --bg:#f7f9fb; --panel:#ffffff; --accent:#007acc; --muted:#666;
      --good:#dff0d8; --warn:#fff4cc; --bad:#fde2e2; --expert:#f8d7da;
    }
    body{margin:0;font-family:Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);display:flex;flex-direction:column;align-items:center;gap:12px;padding:18px;}
    .container{display:flex;gap:18px;align-items:flex-start;}
    canvas{background:#fff;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,0.06);}
    .controls{width:360px;background:var(--panel);padding:12px;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,0.06);}
    .row{display:flex;align-items:center;gap:8px;margin:6px 0;}
    label{font-size:14px;color:var(--muted);}
    .difficulty .opt{padding:6px 8px;border-radius:6px;cursor:pointer;margin-right:6px;border:1px solid transparent;}
    .opt input{margin-right:6px;}
    .opt.easy{background:var(--good);} .opt.med{background:var(--warn);} .opt.hard{background:var(--bad);} .opt.xp{background:var(--expert);}
    .btn{background:var(--accent);color:white;padding:8px 12px;border-radius:6px;border:none;cursor:pointer;font-weight:600;}
    .status{font-size:13px;color:var(--muted);margin-top:8px;}
    .footer{font-size:12px;color:#888;margin-top:6px}
  </style>
</head>
<body>
  <h2>Generador de Sudoku — Web</h2>
  <div class="container">
    <canvas id="board" width="540" height="540"></canvas>
    <div class="controls">
      <div class="row difficulty">
        <label style="width:80px">Dificultad:</label>
        <label class="opt easy"><input type="radio" name="diff" value="Fácil">Fácil</label>
        <label class="opt med"><input type="radio" name="diff" value="Medio" checked>Medio</label>
        <label class="opt hard"><input type="radio" name="diff" value="Difícil">Difícil</label>
        <label class="opt xp"><input type="radio" name="diff" value="Experto">Experto</label>
      </div>

      <div class="row">
        <label style="width:120px">Velocidad aparición (ms):</label>
        <input id="speed" type="range" min="0" max="200" value="30" />
        <span id="speedVal" style="width:36px;text-align:center;color:var(--muted)"></span>
      </div>

      <div class="row">
        <label style="width:80px">Acciones:</label>
        <button id="regenerate" class="btn">Regenerar Sudoku</button>
      </div>

      <div class="status" id="status">Listo</div>
    </div>
  </div>

<script>
const canvas = document.getElementById('board');
const ctx = canvas.getContext('2d');
const SIZE = 9;
const CELL = canvas.width / SIZE;
let grid = Array.from({length:SIZE},()=>Array(SIZE).fill(0));
const numberListInit = [1,2,3,4,5,6,7,8,9];
let counter = 0;

const difficultyMap = { "Fácil":2, "Medio":5, "Difícil":10, "Experto":20 };
const speedInput = document.getElementById('speed');
const speedVal = document.getElementById('speedVal');
const statusEl = document.getElementById('status');
const regenerateBtn = document.getElementById('regenerate');

speedVal.textContent = speedInput.value;

speedInput.addEventListener('input', ()=> speedVal.textContent = speedInput.value);
regenerateBtn.addEventListener('click', ()=> generatePuzzle());

function sleep(ms){ return new Promise(r => setTimeout(r, ms)); }

function deepCopy(g){ return g.map(row => row.slice()); }

function shuffle(arr){
  for(let i=arr.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
}

function findEmpty(g){
  for(let i=0;i<81;i++){
    const r = Math.floor(i/9), c = i%9;
    if(g[r][c]===0) return {r,c};
  }
  return null;
}

function isInCol(g,col,val){
  for(let r=0;r<9;r++) if(g[r][col]===val) return true;
  return false;
}
function squareValues(g,row,col){
  const r0 = Math.floor(row/3)*3, c0 = Math.floor(col/3)*3;
  return [...g[r0].slice(c0,c0+3), ...g[r0+1].slice(c0,c0+3), ...g[r0+2].slice(c0,c0+3)];
}

// solveGrid: cuenta soluciones; usa 'counter' global y se detiene si >1
function solveGrid(g){
  for(let i=0;i<81;i++){
    const row = Math.floor(i/9), col = i%9;
    if(g[row][col]===0){
      for(let value=1; value<=9; value++){
        if(g[row].includes(value)) continue;
        if(isInCol(g,col,value)) continue;
        const sq = squareValues(g,row,col);
        if(sq.includes(value)) continue;
        g[row][col]=value;
        solveGrid(g);
        if(counter>1){ g[row][col]=0; return; }
      }
      g[row][col]=0;
      return;
    }
  }
  counter++;
}

// fillGrid: genera tablero completo (recursivo)
function fillGrid(g){
  const pos = findEmpty(g);
  if(!pos) return true;
  const {r,c}=pos;
  const numbers = numberListInit.slice();
  shuffle(numbers);
  for(const value of numbers){
    if(g[r].includes(value)) continue;
    if(isInCol(g,c,value)) continue;
    const sq = squareValues(g,r,c);
    if(sq.includes(value)) continue;
    g[r][c]=value;
    if(fillGrid(g)) return true;
  }
  g[r][c]=0;
  return false;
}


function drawGridVisible(g){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  // lines
  for(let i=0;i<=SIZE;i++){
    ctx.beginPath();
    ctx.lineWidth = (i%3===0)?3:1;
    ctx.strokeStyle = '#333';
    ctx.moveTo(i*CELL,0);
    ctx.lineTo(i*CELL,canvas.height);
    ctx.stroke();
    ctx.beginPath();
    ctx.moveTo(0,i*CELL);
    ctx.lineTo(canvas.width,i*CELL);
    ctx.stroke();
  }
  // numbers
  ctx.textAlign='center';
  ctx.textBaseline='middle';
  ctx.fillStyle='#000';
  ctx.font = `${Math.floor(CELL*0.55)}px Arial`;
  for(let r=0;r<9;r++){
    for(let c=0;c<9;c++){
      const val = g[r][c];
      if(val!==0){
        ctx.fillText(String(val), c*CELL + CELL/2, r*CELL + CELL/2);
      }
    }
  }
}

async function generatePuzzle(){
  statusEl.textContent = 'Generando...';
  regenerateBtn.disabled = true;
  document.querySelectorAll('input[name="diff"]').forEach(i=>i.disabled=true);

  grid = Array.from({length:9},()=>Array(9).fill(0));
  drawGridVisible(grid);

  const temp = Array.from({length:9},()=>Array(9).fill(0));
  fillGrid(temp);
  const solutionGrid = deepCopy(temp);

  const puzzleGrid = deepCopy(solutionGrid);
  let attempts = difficultyMap[getSelectedDifficulty()] || 5;
  while(attempts>0){
    const rr = Math.floor(Math.random()*9), cc = Math.floor(Math.random()*9);
    if(puzzleGrid[rr][cc]===0) continue;
    const backup = puzzleGrid[rr][cc];
    puzzleGrid[rr][cc]=0;
    const copyGrid = deepCopy(puzzleGrid);
    counter = 0;
    solveGrid(copyGrid);
    if(counter!==1){
      puzzleGrid[rr][cc]=backup;
      attempts--;
    }
  }

  const cells = [];
  for(let r=0;r<9;r++) for(let c=0;c<9;c++) if(puzzleGrid[r][c]!==0) cells.push([r,c]);
  shuffle(cells);
  const delay = Number(speedInput.value);
  for(const [r,c] of cells){
    grid[r][c] = puzzleGrid[r][c];
    drawGridVisible(grid);
    await sleep(delay);
  }

  statusEl.textContent = `Sudoku listo — Dificultad: ${getSelectedDifficulty()}`;
  regenerateBtn.disabled = false;
  document.querySelectorAll('input[name="diff"]').forEach(i=>i.disabled=false);
}

function getSelectedDifficulty(){
  const el = document.querySelector('input[name="diff"]:checked');
  return el ? el.value : 'Medio';
}


</script>
</body>
</html>
desarrolladores: Ricardo Nahum, Juan Eduardo y Julian Emmanuel